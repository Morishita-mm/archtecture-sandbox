# ==============================================================================
# Development Status Update
# ==============================================================================
# 最終更新: 2025-12-11
# 更新内容: コンポーネントのグループ化（SubFlow）、親子関係の制御ロジック実装
# ==============================================================================

project_status:
  phase: "Visual Expression Enhancement"
  latest_milestone: "Component Grouping & Auto-Layout Logic Implemented"

# ------------------------------------------------------------------------------
# Updated Operational Details (動作仕様の更新)
# ------------------------------------------------------------------------------
operational_details:
  grouping_behavior:
    description: "VPCやAZなどのグループノードと、その中に配置される子ノードの挙動定義"
    rules:
      - "Attach (吸着): グループの上にノードをドロップすると自動的に子要素となる"
      - "Containment (封じ込め): 子ノードは親グループの枠外にドラッグできない (extent: 'parent')"
      - "Auto Expansion (自動拡大): 子ノードが親のサイズを超える位置に配置された場合、親が自動的に拡大する"
      - "Detach (解除): プロパティパネルの「グループから切り離す」ボタンでのみ親子関係を解除可能"
      - "Resize Limit (縮小制限): 親グループは、子ノードが見切れるサイズまで縮小できない"

  new_features:
    - name: "コンポーネントのグループ化 (SubFlow)"
      status: "Implemented"
      details:
        tech: "React Flow v11 Nesting API (parentNode, extent)"
        components: "GroupNode (Resizable container), CustomNode (Child)"
    
    - name: "親子関係の管理UI"
      status: "Implemented"
      details:
        ui: "プロパティパネルへの「解除ボタン」追加"
        ux: "ドラッグによる誤解除の防止（ボタン操作に限定）"

    - name: "チャレンジモード（シナリオ共有）"
      status: "Implemented"
      details:
        method: "URL Query Parameter (Base64 Encoded JSON)"
        ux: "評価結果画面から発行 -> 受信者はトップ画面で「挑戦状モーダル」経由で開始"

    - name: "URL短縮機能 (Backend Proxy)"
      status: "Implemented"
      details:
        endpoint: "POST /api/shorten"
        service: "TinyURL API"

# ------------------------------------------------------------------------------
# Recent Changes (直近の変更点)
# ------------------------------------------------------------------------------
recent_changes:
  # --- UI / UX / Logic ---
  - id: feat_grouping_logic
    category: "Logic"
    description: "グループノード（VPC等）への吸着判定、親の自動リサイズ、子ノードのドラッグ範囲制限ロジックを実装"

  - id: ux_detach_button
    category: "UI"
    description: "プロパティパネルに「グループから切り離す」ボタンを追加し、意図しない親子関係の解除を防止"

  - id: fix_group_resize
    category: "Logic"
    description: "GroupNodeが内包する子ノードの座標を計算し、リサイズ時の最小サイズ(minWidth/minHeight)を動的に制限するよう修正"

  # --- Previous Features ---
  - id: feat_challenge_mode
    category: "Feature"
    description: "シナリオ設定をBase64エンコードしてURLで共有する機能(Challenge Mode)を実装"

  - id: feat_url_shortener_api
    category: "Backend"
    description: "TinyURL APIを叩くプロキシエンドポイントをRustバックエンドに追加"

# ------------------------------------------------------------------------------
# Updated Limitations (制約事項の更新)
# ------------------------------------------------------------------------------
limitations_update:
  - name: "グループのネスト"
    status: "Restricted"
    detail: "現状では「グループの中にグループを入れる」多重ネストは複雑化回避のため禁止している"