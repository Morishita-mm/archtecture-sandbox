# ==============================================================================
# Development Status Update
# ==============================================================================
# 最終更新: 2025-12-10
# 更新内容: データ永続化（ローカル）、バージョン管理、UI動線最適化
# ==============================================================================

project_status:
  phase: "Feature Expansion & Polish"
  latest_milestone: "Local Persistence & Version Control Implemented"

# ------------------------------------------------------------------------------
# Updated Operational Details (動作仕様の更新)
# ------------------------------------------------------------------------------
operational_details:
  ui_flow_update:
    description: "トップ画面で「新規開始」か「続きから再開」を選択可能なフローに変更"
    steps:
      - 'ENTRY_SCREEN': 
          action: "ユーザーは「シナリオカード選択」または「既存プロジェクト読み込み」を行う"
          component: "ScenarioSelectionScreen.tsx"
      - 'LOAD_FLOW': 
          trigger: "「既存プロジェクトを読み込む」ボタン（ホバーエフェクト付）"
          process: "JSONファイル選択 -> Base64デコード -> 構造/バージョン検証 -> 状態復元"
          restore_target: "チャット履歴, ノード/エッジ, メモ, AI評価結果"
      - 'SAVE_FLOW': 
          trigger: "キャンバス画面右上の保存ボタン"
          process: "全StateをJSON化 -> Base64エンコード -> ファイル出力"
          naming_convention: "<シナリオ名>_v<バージョン>.json"
          version_control: "保存実行後、内部バージョンを自動インクリメント (例: 1.0 -> 2.0)"

  new_features:
    - name: "ローカルデータ永続化"
      status: "Implemented"
      details: 
        method: "Client-side JSON File Download/Upload"
        security: "Base64 Obfuscation (システムプロンプト隠蔽のため)"
        scope: "Full State Persistence (Diagram, Chat, Memo, Evaluation Result)"
    
    - name: "簡易バージョン管理"
      status: "Implemented"
      details:
        logic: "ファイル読み込み時にバージョンを解析し、次回保存時に +1.0 する"
        format: "String (e.g., '1.0', '2.0')"

# ------------------------------------------------------------------------------
# Recent Changes (直近の変更点)
# ------------------------------------------------------------------------------
recent_changes:
  - id: feat_local_persistence
    category: "Feature"
    description: "RDSを使用せず、ローカルファイル(JSON)によるデータの完全な保存・復元機能を実装"
  
  - id: feat_save_evaluation
    category: "Feature"
    description: "AIによる評価結果(EvaluationResult)も保存データに含め、評価後の状態から再開可能に拡張"
  
  - id: feat_versioning
    category: "Logic"
    description: "保存ファイル名にバージョンを含め、読み込み→保存のサイクルでバージョンを自動更新するロジックを追加"
  
  - id: ux_load_button
    category: "UI/UX"
    description: "プロジェクト読み込みボタンをヘッダーからトップ画面へ移動し、動線を短縮。ホバーアニメーションを追加"

  - id: fix_build_error
    category: "Bugfix"
    description: "ReactFlowのEdge型キャストにおけるTS型定義エラーを修正"

# ------------------------------------------------------------------------------
# Updated Limitations (制約事項の更新)
# ------------------------------------------------------------------------------
limitations_update:
  - name: "データ共有"
    status: "Manual"
    detail: "サーバーに保存しないため、他者への共有はJSONファイルの送付が必要"
  
  - name: "セキュリティ（隠しパラメータ）"
    status: "Obfuscated"
    detail: "暗号化ではなくBase64エンコードによる難読化。技術的なユーザーであればデコードして隠し要件を閲覧可能（仕様として許容）"